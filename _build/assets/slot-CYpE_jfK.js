import{i as ge}from"./region-B37KYJC6.js";import{v as X,a as x,g as V,w as J,x as Q,e as C,n as ye,o as Y,y as L,z as ve,A as _e,u as we,B as ee,b as be,D as xe,f as Pe,s as B}from"./web-BPZ8wtEZ.js";function Ce(){let e=new Set;function t(r){return e.add(r),()=>e.delete(r)}let n=!1;function o(r,s){if(n)return!(n=!1);const a={to:r,options:s,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const l of e)l.listener({...a,from:l.location,retry:h=>{h&&(n=!0),l.navigate(r,{...s,resolve:!1})}});return!a.defaultPrevented}return{subscribe:t,confirm:o}}let N;function te(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),N=window.history.state._depth}te();function Ye(e){return{...e,_depth:window.history.state&&window.history.state._depth}}function et(e,t){let n=!1;return()=>{const o=N;te();const r=o==null?null:N-o;if(n){n=!1;return}r&&t(r)?(n=!0,window.history.go(-r)):e()}}const Re=/^(?:[a-z0-9]+:)?\/\//i,ke=/^\/+|(\/)\/+$/g,Oe="http://sr";function O(e,t=!1){const n=e.replace(ke,"$1");return n?t||/^[?#]/.test(n)?n:"/"+n:""}function D(e,t,n){if(Re.test(t))return;const o=O(e),r=n&&O(n);let s="";return!r||t.startsWith("/")?s=o:r.toLowerCase().indexOf(o.toLowerCase())!==0?s=o+r:s=r,(s||"/")+O(t,!s)}function Te(e,t){if(e==null)throw new Error(t);return e}function Ee(e,t){return O(e).replace(/\/*(\*.*)?$/g,"")+O(t)}function ne(e){const t={};return e.searchParams.forEach((n,o)=>{t[o]=n}),t}function Se(e,t,n){const[o,r]=e.split("/*",2),s=o.split("/").filter(Boolean),a=s.length;return l=>{const h=l.split("/").filter(Boolean),f=h.length-a;if(f<0||f>0&&r===void 0&&!t)return null;const p={path:a?"":"/",params:{}},i=m=>n===void 0?void 0:n[m];for(let m=0;m<a;m++){const c=s[m],g=c[0]===":",y=g?h[m]:h[m].toLowerCase(),v=g?c.slice(1):c.toLowerCase();if(g&&F(y,i(v)))p.params[v]=y;else if(g||!F(y,v))return null;p.path+=`/${y}`}if(r){const m=f?h.slice(-f).join("/"):"";if(F(m,i(r)))p.params[r]=m;else return null}return p}}function F(e,t){const n=o=>o===e;return t===void 0?!0:typeof t=="string"?n(t):typeof t=="function"?t(e):Array.isArray(t)?t.some(n):t instanceof RegExp?t.test(e):!1}function Ie(e){const[t,n]=e.pattern.split("/*",2),o=t.split("/").filter(Boolean);return o.reduce((r,s)=>r+(s.startsWith(":")?2:3),o.length-(n===void 0?0:1))}function re(e){const t=new Map,n=V();return new Proxy({},{get(o,r){return t.has(r)||X(n,()=>t.set(r,x(()=>e()[r]))),t.get(r)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(e())}})}function oe(e){let t=/(\/?\:[^\/]+)\?/.exec(e);if(!t)return[e];let n=e.slice(0,t.index),o=e.slice(t.index+t[0].length);const r=[n,n+=t[1]];for(;t=/^(\/\:[^\/]+)\?/.exec(o);)r.push(n+=t[1]),o=o.slice(t[0].length);return oe(o).reduce((s,a)=>[...s,...r.map(l=>l+a)],[])}const Ae=100,Le=Q(),De=Q(),se=()=>Te(J(Le),"<A> and 'use' router primitives can be only used inside a Route."),Me=()=>se().navigatorFactory(),tt=()=>se().params;function je(e,t=""){const{component:n,preload:o,load:r,children:s,info:a}=e,l=!s||Array.isArray(s)&&!s.length,h={key:e,component:n,preload:o||r,info:a};return ie(e.path).reduce((f,p)=>{for(const i of oe(p)){const m=Ee(t,i);let c=l?m:m.split("/*",1)[0];c=c.split("/").map(g=>g.startsWith(":")||g.startsWith("*")?g:encodeURIComponent(g)).join("/"),f.push({...h,originalPath:p,pattern:c,matcher:Se(c,!l,e.matchFilters)})}return f},[])}function Be(e,t=0){return{routes:e,score:Ie(e[e.length-1])*1e4-t,matcher(n){const o=[];for(let r=e.length-1;r>=0;r--){const s=e[r],a=s.matcher(n);if(!a)return null;o.unshift({...a,route:s})}return o}}}function ie(e){return Array.isArray(e)?e:[e]}function Fe(e,t="",n=[],o=[]){const r=ie(e);for(let s=0,a=r.length;s<a;s++){const l=r[s];if(l&&typeof l=="object"){l.hasOwnProperty("path")||(l.path="");const h=je(l,t);for(const f of h){n.push(f);const p=Array.isArray(l.children)&&l.children.length===0;if(l.children&&!p)Fe(l.children,f.pattern,n,o);else{const i=Be([...n],o.length);o.push(i)}n.pop()}}}return n.length?o:o.sort((s,a)=>a.score-s.score)}function U(e,t){for(let n=0,o=e.length;n<o;n++){const r=e[n].matcher(t);if(r)return r}return[]}function Ue(e,t){const n=new URL(Oe),o=x(h=>{const f=e();try{return new URL(f,n)}catch{return console.error(`Invalid path ${f}`),h}},n,{equals:(h,f)=>h.href===f.href}),r=x(()=>o().pathname),s=x(()=>o().search,!0),a=x(()=>o().hash),l=()=>"";return{get pathname(){return r()},get search(){return s()},get hash(){return a()},get state(){return t()},get key(){return l()},query:re(Y(s,()=>ne(o())))}}let b;function Ne(){return b}let R=!1;function $e(){return R}function nt(e){R=e}function rt(e,t,n,o={}){const{signal:[r,s],utils:a={}}=e,l=a.parsePath||(u=>u),h=a.renderPath||(u=>u),f=a.beforeLeave||Ce(),p=D("",o.base||"");if(p===void 0)throw new Error(`${p} is not a valid base path`);p&&!r().value&&s({value:p,replace:!0,scroll:!1});const[i,m]=C(!1);let c;const g=(u,d)=>{d.value===y()&&d.state===w()||(c===void 0&&m(!0),b=u,c=d,L(()=>{c===d&&(v(c.value),ue(c.state),ve(),K[1]([]))}).finally(()=>{c===d&&_e(()=>{b=void 0,u==="navigate"&&de(c),m(!1),c=void 0})}))},[y,v]=C(r().value),[w,ue]=C(r().state),E=Ue(y,w),S=[],K=C([]),W=x(()=>typeof o.transformUrl=="function"?U(t(),o.transformUrl(E.pathname)):U(t(),E.pathname)),fe=re(()=>{const u=W(),d={};for(let _=0;_<u.length;_++)Object.assign(d,u[_].params);return d}),q={pattern:p,path:()=>p,outlet:()=>null,resolvePath(u){return D(p,u)}};return ye(Y(r,u=>g("native",u),{defer:!0})),{base:q,location:E,params:fe,isRouting:i,renderPath:h,parsePath:l,navigatorFactory:he,matches:W,beforeLeave:f,preloadRoute:me,singleFlight:o.singleFlight===void 0?!0:o.singleFlight,submissions:K};function pe(u,d,_){we(()=>{if(typeof d=="number"){d&&(a.go?a.go(d):console.warn("Router integration does not support relative routing"));return}const I=!d||d[0]==="?",{replace:M,resolve:P,scroll:j,state:k}={replace:!1,resolve:!I,scroll:!0,..._};let Xe;const A=P?u.resolvePath(d):D(I&&E.pathname||"",d);if(A===void 0)throw new Error(`Path '${d}' is not a routable path`);if(S.length>=Ae)throw new Error("Too many redirects");const G=y();(A!==G||k!==w())&&(ee||f.confirm(A,_)&&(S.push({value:G,replace:M,scroll:j,state:w()}),g("navigate",{value:A,state:k})))})}function he(u){return u=u||J(De)||q,(d,_)=>pe(u,d,_)}function de(u){const d=S[0];d&&(s({...u,replace:d.replace,scroll:d.scroll}),S.length=0)}function me(u,d={}){const _=U(t(),u.pathname),I=b;b="preload";for(let M in _){const{route:P,params:j}=_[M];P.component&&P.component.preload&&P.component.preload();const{preload:k}=P;R=!0,d.preloadData&&k&&X(n(),()=>k({params:j,location:{pathname:u.pathname,search:u.search,hash:u.hash,query:ne(u),state:null,key:""},intent:"preload"})),R=!1}b=I}}function ot(e,t,n,o){const{base:r,location:s,params:a}=e,{pattern:l,component:h,preload:f}=o().route,p=x(()=>o().path);h&&h.preload&&h.preload(),R=!0;const i=f?f({params:a,location:s,intent:b||"initial"}):void 0;return R=!1,{parent:t,pattern:l,path:p,outlet:()=>h?be(h,{params:a,location:s,data:i,get children(){return n()}}):n(),resolvePath(c){return D(r.path(),c,p())}}}const Ze="Location",He=5e3,Ke=18e4;let $=new Map;setInterval(()=>{const e=Date.now();for(let[t,n]of $.entries())!n[3].count&&e-n[0]>Ke&&$.delete(t)},3e5);function Z(){return $}function T(e,t){e.GET&&(e=e.GET);const n=(...o)=>{const r=Z(),s=Ne(),a=$e(),h=V()?Me():void 0,f=Date.now(),p=t+z(o);let i=r.get(p),m;if(xe()&&!ee&&(m=!0,Pe(()=>i[3].count--)),i&&i[0]&&(s==="native"||i[3].count||Date.now()-i[0]<He)){m&&(i[3].count++,i[3][0]()),i[2]==="preload"&&s!=="preload"&&(i[0]=f);let y=i[1];return s!=="preload"&&(y="then"in i[1]?i[1].then(g(!1),g(!0)):g(!1)(i[1]),s==="navigate"&&L(()=>i[3][1](i[0]))),a&&"then"in y&&y.catch(()=>{}),y}let c=B.context&&B.has(p)?B.load(p):e(...o);return i?(i[0]=f,i[1]=c,i[2]=s,s==="navigate"&&L(()=>i[3][1](i[0]))):(r.set(p,i=[f,c,s,C(f)]),i[3].count=0),m&&(i[3].count++,i[3][0]()),s!=="preload"&&(c="then"in c?c.then(g(!1),g(!0)):g(!1)(c)),a&&"then"in c&&c.catch(()=>{}),c;function g(y){return async v=>{if(v instanceof Response){const w=v.headers.get(Ze);if(w!==null){h&&w.startsWith("/")?L(()=>{h(w,{replace:!0})}):window.location.href=w;return}v.customBody&&(v=await v.customBody())}if(y)throw v;return v}}};return n.keyFor=(...o)=>t+z(o),n.key=t,n}T.set=(e,t)=>{const n=Z(),o=Date.now();let r=n.get(e);r?(r[0]=o,r[1]=t,r[2]="preload"):(n.set(e,r=[o,t,,C(o)]),r[3].count=0)};T.clear=()=>Z().clear();function z(e){return JSON.stringify(e,(t,n)=>We(n)?Object.keys(n).sort().reduce((o,r)=>(o[r]=n[r],o),{}):n)}function We(e){let t;return e!=null&&typeof e=="object"&&(!(t=Object.getPrototypeOf(e))||t===Object.prototype)}function ae(){return{id:"",gamemode:-1,maxPlayers:0,script:0}}function qe(e){const t=ae();return{id:e.resource_id!==void 0?e.resource_id:t.id,gamemode:e.resource_mode!==void 0?e.resource_mode:t.gamemode,maxPlayers:e.resource_max_player!==void 0?e.resource_max_player:t.maxPlayers,script:e.sandbox_script!==void 0?e.sandbox_script:t.script}}const Ge={0:"Original",2:"Team Deathmatch",5:"Team Deathmatch (Bot)",8:"Zombie Classic",9:"Zombie Mutant",14:"Zombie Hero",16:"Soccer",20:"Zombie Escape",22:"Gun Deathmatch",23:"Basic",24:"Zombie (Bot)",38:"Create",39:"Play",40:"All-Star",45:"Zombie Z",49:"Hide and Seek",52:"Zombie Shelter",53:"Scenario TX",54:"Zombie Evolution",[-1]:"!!!ERROR_FIXME!!!"};function ce(){return{id:"",map:ae(),parent:"",title:"",description:"",creatorName:"",categoryType:0,permissionType:0,tags:[],playCounts:0,likeCounts:0,bookmarkCounts:0,cubeCounts:0,cheeringKingName:"",savegroupId:"",imageId:"",groupId:"",noticeType:0,eventType:0}}Object.assign(ce(),{id:"management"});const ze="/thumbnails/default.webp",st=T(async e=>e||ze,"slot_thumbnail");function le(e,t){let n;t.imageId?n=e.vmg(t.imageId).href:t.map&&(n=`/thumbnails/${t.map.gamemode}.webp`,ge(n)||(n=void 0));let o="",r="";return t.map&&(o=e.vxl(t.map.id).href,r=Ge[t.map.gamemode]),{imageUrl:n,mapUrl:o,gamemodeName:r}}function H(e){const t=ce();return{id:e.id!==void 0?e.id:t.id,map:e.resource_id!==void 0?qe(e):t.map,parent:e.parents_slot_id?H(e.parents_slot_id):t.parent,title:e.title!==void 0?e.title:t.title,description:e.description!==void 0?e.description:t.description,creatorName:e.creator_nickname!==void 0?e.creator_nickname:t.creatorName,categoryType:e.slot_category!==void 0?e.slot_category:t.categoryType,permissionType:e.permission!==void 0?e.permission:t.permissionType,tags:e.tags!==void 0?e.tags:t.tags,playCounts:e.play_count!==void 0?e.play_count:t.playCounts,likeCounts:e.like_count!==void 0?e.like_count:t.likeCounts,bookmarkCounts:e.bookmark_count!==void 0?e.bookmark_count:t.bookmarkCounts,cubeCounts:e.cube_count!==void 0?e.cube_count:t.cubeCounts,cheeringKingName:e.cheering_king!==void 0?e.cheering_king:t.cheeringKingName,savegroupId:e.savegroup_id!==void 0?e.savegroup_id:t.savegroupId,imageId:e.image_id!==void 0?e.image_id:t.imageId,groupId:e.group_id!==void 0?e.group_id:t.groupId,noticeType:e.notice_type!==void 0?e.notice_type:t.noticeType,eventType:e.is_event!==void 0?e.is_event:t.eventType}}const it=T(async(e,t)=>{let n={};try{const r=await e.api(`v5/slots/simple?ids=${t}`);Object.assign(n,r[0])}catch{}Object.assign(n,await e.api(`v6/slots/detail/${t}`));const o=H(n);return o._html=le(e,o),o},"slot_by_id"),at=T(async e=>{const t=await e.api("v6/slots/list/all");for(const n of Object.values(t))for(const o in n){const r=H(n[o]);r._html=le(e,r),n[o]=r}return t},"slot_list_all");export{Le as R,ze as S,rt as a,De as b,Fe as c,ot as d,te as e,Ce as f,Ne as g,at as h,tt as i,it as j,Ye as k,Oe as m,et as n,nt as s,Me as u,st as v};
