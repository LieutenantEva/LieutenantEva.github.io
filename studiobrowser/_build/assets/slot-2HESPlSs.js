import{v as X,a as P,g as V,w as J,x as Q,e as C,n as ge,o as Y,y as A,z as ye,A as ve,u as we,B as ee,b as _e,D as be,f as Pe,s as B}from"./web-BPZ8wtEZ.js";function xe(){let e=new Set;function t(r){return e.add(r),()=>e.delete(r)}let n=!1;function o(r,s){if(n)return!(n=!1);const a={to:r,options:s,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const c of e)c.listener({...a,from:c.location,retry:h=>{h&&(n=!0),c.navigate(r,{...s,resolve:!1})}});return!a.defaultPrevented}return{subscribe:t,confirm:o}}let U;function te(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),U=window.history.state._depth}te();function Je(e){return{...e,_depth:window.history.state&&window.history.state._depth}}function Qe(e,t){let n=!1;return()=>{const o=U;te();const r=o==null?null:U-o;if(n){n=!1;return}r&&t(r)?(n=!0,window.history.go(-r)):e()}}const Ce=/^(?:[a-z0-9]+:)?\/\//i,Re=/^\/+|(\/)\/+$/g,ke="http://sr";function O(e,t=!1){const n=e.replace(Re,"$1");return n?t||/^[?#]/.test(n)?n:"/"+n:""}function D(e,t,n){if(Ce.test(t))return;const o=O(e),r=n&&O(n);let s="";return!r||t.startsWith("/")?s=o:r.toLowerCase().indexOf(o.toLowerCase())!==0?s=o+r:s=r,(s||"/")+O(t,!s)}function Oe(e,t){if(e==null)throw new Error(t);return e}function Se(e,t){return O(e).replace(/\/*(\*.*)?$/g,"")+O(t)}function ne(e){const t={};return e.searchParams.forEach((n,o)=>{t[o]=n}),t}function Te(e,t,n){const[o,r]=e.split("/*",2),s=o.split("/").filter(Boolean),a=s.length;return c=>{const h=c.split("/").filter(Boolean),f=h.length-a;if(f<0||f>0&&r===void 0&&!t)return null;const p={path:a?"":"/",params:{}},i=m=>n===void 0?void 0:n[m];for(let m=0;m<a;m++){const l=s[m],g=l[0]===":",y=g?h[m]:h[m].toLowerCase(),v=g?l.slice(1):l.toLowerCase();if(g&&F(y,i(v)))p.params[v]=y;else if(g||!F(y,v))return null;p.path+=`/${y}`}if(r){const m=f?h.slice(-f).join("/"):"";if(F(m,i(r)))p.params[r]=m;else return null}return p}}function F(e,t){const n=o=>o===e;return t===void 0?!0:typeof t=="string"?n(t):typeof t=="function"?t(e):Array.isArray(t)?t.some(n):t instanceof RegExp?t.test(e):!1}function Ee(e){const[t,n]=e.pattern.split("/*",2),o=t.split("/").filter(Boolean);return o.reduce((r,s)=>r+(s.startsWith(":")?2:3),o.length-(n===void 0?0:1))}function re(e){const t=new Map,n=V();return new Proxy({},{get(o,r){return t.has(r)||X(n,()=>t.set(r,P(()=>e()[r]))),t.get(r)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(e())}})}function oe(e){let t=/(\/?\:[^\/]+)\?/.exec(e);if(!t)return[e];let n=e.slice(0,t.index),o=e.slice(t.index+t[0].length);const r=[n,n+=t[1]];for(;t=/^(\/\:[^\/]+)\?/.exec(o);)r.push(n+=t[1]),o=o.slice(t[0].length);return oe(o).reduce((s,a)=>[...s,...r.map(c=>c+a)],[])}const Ie=100,Le=Q(),Ae=Q(),se=()=>Oe(J(Le),"<A> and 'use' router primitives can be only used inside a Route."),De=()=>se().navigatorFactory(),Ye=()=>se().params;function Me(e,t=""){const{component:n,preload:o,load:r,children:s,info:a}=e,c=!s||Array.isArray(s)&&!s.length,h={key:e,component:n,preload:o||r,info:a};return ae(e.path).reduce((f,p)=>{for(const i of oe(p)){const m=Se(t,i);let l=c?m:m.split("/*",1)[0];l=l.split("/").map(g=>g.startsWith(":")||g.startsWith("*")?g:encodeURIComponent(g)).join("/"),f.push({...h,originalPath:p,pattern:l,matcher:Te(l,!c,e.matchFilters)})}return f},[])}function je(e,t=0){return{routes:e,score:Ee(e[e.length-1])*1e4-t,matcher(n){const o=[];for(let r=e.length-1;r>=0;r--){const s=e[r],a=s.matcher(n);if(!a)return null;o.unshift({...a,route:s})}return o}}}function ae(e){return Array.isArray(e)?e:[e]}function Be(e,t="",n=[],o=[]){const r=ae(e);for(let s=0,a=r.length;s<a;s++){const c=r[s];if(c&&typeof c=="object"){c.hasOwnProperty("path")||(c.path="");const h=Me(c,t);for(const f of h){n.push(f);const p=Array.isArray(c.children)&&c.children.length===0;if(c.children&&!p)Be(c.children,f.pattern,n,o);else{const i=je([...n],o.length);o.push(i)}n.pop()}}}return n.length?o:o.sort((s,a)=>a.score-s.score)}function N(e,t){for(let n=0,o=e.length;n<o;n++){const r=e[n].matcher(t);if(r)return r}return[]}function Fe(e,t){const n=new URL(ke),o=P(h=>{const f=e();try{return new URL(f,n)}catch{return console.error(`Invalid path ${f}`),h}},n,{equals:(h,f)=>h.href===f.href}),r=P(()=>o().pathname),s=P(()=>o().search,!0),a=P(()=>o().hash),c=()=>"";return{get pathname(){return r()},get search(){return s()},get hash(){return a()},get state(){return t()},get key(){return c()},query:re(Y(s,()=>ne(o())))}}let b;function Ne(){return b}let R=!1;function Ue(){return R}function et(e){R=e}function tt(e,t,n,o={}){const{signal:[r,s],utils:a={}}=e,c=a.parsePath||(u=>u),h=a.renderPath||(u=>u),f=a.beforeLeave||xe(),p=D("",o.base||"");if(p===void 0)throw new Error(`${p} is not a valid base path`);p&&!r().value&&s({value:p,replace:!0,scroll:!1});const[i,m]=C(!1);let l;const g=(u,d)=>{d.value===y()&&d.state===_()||(l===void 0&&m(!0),b=u,l=d,A(()=>{l===d&&(v(l.value),ue(l.state),ye(),K[1]([]))}).finally(()=>{l===d&&ve(()=>{b=void 0,u==="navigate"&&de(l),m(!1),l=void 0})}))},[y,v]=C(r().value),[_,ue]=C(r().state),T=Fe(y,_),E=[],K=C([]),W=P(()=>typeof o.transformUrl=="function"?N(t(),o.transformUrl(T.pathname)):N(t(),T.pathname)),fe=re(()=>{const u=W(),d={};for(let w=0;w<u.length;w++)Object.assign(d,u[w].params);return d}),q={pattern:p,path:()=>p,outlet:()=>null,resolvePath(u){return D(p,u)}};return ge(Y(r,u=>g("native",u),{defer:!0})),{base:q,location:T,params:fe,isRouting:i,renderPath:h,parsePath:c,navigatorFactory:he,matches:W,beforeLeave:f,preloadRoute:me,singleFlight:o.singleFlight===void 0?!0:o.singleFlight,submissions:K};function pe(u,d,w){we(()=>{if(typeof d=="number"){d&&(a.go?a.go(d):console.warn("Router integration does not support relative routing"));return}const I=!d||d[0]==="?",{replace:M,resolve:x,scroll:j,state:k}={replace:!1,resolve:!I,scroll:!0,...w};let ze;const L=x?u.resolvePath(d):D(I&&T.pathname||"",d);if(L===void 0)throw new Error(`Path '${d}' is not a routable path`);if(E.length>=Ie)throw new Error("Too many redirects");const G=y();(L!==G||k!==_())&&(ee||f.confirm(L,w)&&(E.push({value:G,replace:M,scroll:j,state:_()}),g("navigate",{value:L,state:k})))})}function he(u){return u=u||J(Ae)||q,(d,w)=>pe(u,d,w)}function de(u){const d=E[0];d&&(s({...u,replace:d.replace,scroll:d.scroll}),E.length=0)}function me(u,d={}){const w=N(t(),u.pathname),I=b;b="preload";for(let M in w){const{route:x,params:j}=w[M];x.component&&x.component.preload&&x.component.preload();const{preload:k}=x;R=!0,d.preloadData&&k&&X(n(),()=>k({params:j,location:{pathname:u.pathname,search:u.search,hash:u.hash,query:ne(u),state:null,key:""},intent:"preload"})),R=!1}b=I}}function nt(e,t,n,o){const{base:r,location:s,params:a}=e,{pattern:c,component:h,preload:f}=o().route,p=P(()=>o().path);h&&h.preload&&h.preload(),R=!0;const i=f?f({params:a,location:s,intent:b||"initial"}):void 0;return R=!1,{parent:t,pattern:c,path:p,outlet:()=>h?_e(h,{params:a,location:s,data:i,get children(){return n()}}):n(),resolvePath(l){return D(r.path(),l,p())}}}const $e="Location",Ze=5e3,He=18e4;let $=new Map;setInterval(()=>{const e=Date.now();for(let[t,n]of $.entries())!n[3].count&&e-n[0]>He&&$.delete(t)},3e5);function Z(){return $}function S(e,t){e.GET&&(e=e.GET);const n=(...o)=>{const r=Z(),s=Ne(),a=Ue(),h=V()?De():void 0,f=Date.now(),p=t+z(o);let i=r.get(p),m;if(be()&&!ee&&(m=!0,Pe(()=>i[3].count--)),i&&i[0]&&(s==="native"||i[3].count||Date.now()-i[0]<Ze)){m&&(i[3].count++,i[3][0]()),i[2]==="preload"&&s!=="preload"&&(i[0]=f);let y=i[1];return s!=="preload"&&(y="then"in i[1]?i[1].then(g(!1),g(!0)):g(!1)(i[1]),s==="navigate"&&A(()=>i[3][1](i[0]))),a&&"then"in y&&y.catch(()=>{}),y}let l=B.context&&B.has(p)?B.load(p):e(...o);return i?(i[0]=f,i[1]=l,i[2]=s,s==="navigate"&&A(()=>i[3][1](i[0]))):(r.set(p,i=[f,l,s,C(f)]),i[3].count=0),m&&(i[3].count++,i[3][0]()),s!=="preload"&&(l="then"in l?l.then(g(!1),g(!0)):g(!1)(l)),a&&"then"in l&&l.catch(()=>{}),l;function g(y){return async v=>{if(v instanceof Response){const _=v.headers.get($e);if(_!==null){h&&_.startsWith("/")?A(()=>{h(_,{replace:!0})}):window.location.href=_;return}v.customBody&&(v=await v.customBody())}if(y)throw v;return v}}};return n.keyFor=(...o)=>t+z(o),n.key=t,n}S.set=(e,t)=>{const n=Z(),o=Date.now();let r=n.get(e);r?(r[0]=o,r[1]=t,r[2]="preload"):(n.set(e,r=[o,t,,C(o)]),r[3].count=0)};S.clear=()=>Z().clear();function z(e){return JSON.stringify(e,(t,n)=>Ke(n)?Object.keys(n).sort().reduce((o,r)=>(o[r]=n[r],o),{}):n)}function Ke(e){let t;return e!=null&&typeof e=="object"&&(!(t=Object.getPrototypeOf(e))||t===Object.prototype)}function ie(){return{id:"",gamemode:-1,maxPlayers:0,script:0}}function We(e){const t=ie();return{id:e.resource_id!==void 0?e.resource_id:t.id,gamemode:e.resource_mode!==void 0?e.resource_mode:t.gamemode,maxPlayers:e.resource_max_player!==void 0?e.resource_max_player:t.maxPlayers,script:e.sandbox_script!==void 0?e.sandbox_script:t.script}}const qe={0:"Original",2:"Team Deathmatch",5:"Bot Team Deathmatch",8:"Zombie Classic",9:"Zombie Mutant",14:"Zombie Hero",16:"Soccer",20:"Zombie Escape",22:"Gun Deathmatch",23:"Basic",24:"Bot Zombie",38:"Create",39:"Play",40:"All-Star",45:"Zombie Z",49:"Hide and Seek",52:"Zombie Shelter",53:"Scenario TX",54:"Zombie Evolution",[-1]:"!!!ERROR_FIXME!!!"};function ce(){return{id:"",map:ie(),parent:"",title:"",description:"",creatorName:"",categoryType:0,permissionType:0,tags:[],playCounts:0,likeCounts:0,bookmarkCounts:0,cubeCounts:0,cheeringKingName:"",savegroupId:"",imageId:"",groupId:"",noticeType:0,eventType:0}}Object.assign(ce(),{id:"management"});const Ge="/studiobrowser/thumbnails/default.webp",rt=S(async e=>e||Ge,"slot_thumbnail");function le(e,t){let n;t.imageId?n=e.vmg(t.imageId).href:t.map&&(n=`/studiobrowser/thumbnails/${t.map.gamemode}.webp`);let o="",r="",s="";const a=t.map;a&&(o=e.vxl(a.id).href,r=qe[a.gamemode],s=new Date(Number.parseInt(a.id.substring(1,14))).toLocaleString());let c=new Date(Number.parseInt(t.id.substring(1,14))).toLocaleString();return{imageUrl:n,mapUrl:o,gamemodeName:r,createdDate:c,updatedDate:s}}function H(e){const t=ce();return{id:e.id!==void 0?e.id:t.id,map:e.resource_id!==void 0?We(e):t.map,parent:e.parents_slot_id?H(e.parents_slot_id):t.parent,title:e.title!==void 0?e.title:t.title,description:e.description!==void 0?e.description:t.description,creatorName:e.creator_nickname!==void 0?e.creator_nickname:t.creatorName,categoryType:e.slot_category!==void 0?e.slot_category:t.categoryType,permissionType:e.permission!==void 0?e.permission:t.permissionType,tags:e.tags!==void 0?e.tags:t.tags,playCounts:e.play_count!==void 0?e.play_count:t.playCounts,likeCounts:e.like_count!==void 0?e.like_count:t.likeCounts,bookmarkCounts:e.bookmark_count!==void 0?e.bookmark_count:t.bookmarkCounts,cubeCounts:e.cube_count!==void 0?e.cube_count:t.cubeCounts,cheeringKingName:e.cheering_king!==void 0?e.cheering_king:t.cheeringKingName,savegroupId:e.savegroup_id!==void 0?e.savegroup_id:t.savegroupId,imageId:e.image_id!==void 0?e.image_id:t.imageId,groupId:e.group_id!==void 0?e.group_id:t.groupId,noticeType:e.notice_type!==void 0?e.notice_type:t.noticeType,eventType:e.is_event!==void 0?e.is_event:t.eventType}}const ot=S(async(e,t)=>{let n={};try{const r=await e.api(`v5/slots/simple?ids=${t}`);Object.assign(n,r[0])}catch{}Object.assign(n,await e.api(`v6/slots/detail/${t}`));const o=H(n);return o._html=le(e,o),o},"slot_by_id"),st=S(async e=>{const t=await e.api("v6/slots/list/all");for(const n of Object.values(t))for(const o in n){const r=H(n[o]);r._html=le(e,r),n[o]=r}return t},"slot_list_all");export{Le as R,Ge as S,tt as a,Ae as b,Be as c,nt as d,te as e,xe as f,Ne as g,st as h,Ye as i,ot as j,Je as k,ke as m,Qe as n,et as s,De as u,rt as v};
