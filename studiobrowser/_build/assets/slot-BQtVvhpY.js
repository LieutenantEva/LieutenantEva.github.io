import{e as C,v as x,w as E,f as M,x as h,g as N,s as y}from"./web-CPDknjYr.js";import{u as L,g as P,r as Z}from"./region-D77atls7.js";const A="Location",j=5e3,B=18e4;let b=new Map;setInterval(()=>{const e=Date.now();for(let[t,o]of b.entries())!o[3].count&&e-o[0]>B&&b.delete(t)},3e5);function v(){return b}function m(e,t){e.GET&&(e=e.GET);const o=(...r)=>{const i=v(),s=P(),a=Z(),k=N()?L():void 0,g=Date.now(),d=t+I(r);let n=i.get(d),_;if(x()&&!E&&(_=!0,M(()=>n[3].count--)),n&&n[0]&&(s==="native"||n[3].count||Date.now()-n[0]<j)){_&&(n[3].count++,n[3][0]()),n[2]==="preload"&&s!=="preload"&&(n[0]=g);let p=n[1];return s!=="preload"&&(p="then"in n[1]?n[1].then(l(!1),l(!0)):l(!1)(n[1]),s==="navigate"&&h(()=>n[3][1](n[0]))),a&&"then"in p&&p.catch(()=>{}),p}let c=y.context&&y.has(d)?y.load(d):e(...r);return n?(n[0]=g,n[1]=c,n[2]=s,s==="navigate"&&h(()=>n[3][1](n[0]))):(i.set(d,n=[g,c,s,C(g)]),n[3].count=0),_&&(n[3].count++,n[3][0]()),s!=="preload"&&(c="then"in c?c.then(l(!1),l(!0)):l(!1)(c)),a&&"then"in c&&c.catch(()=>{}),c;function l(p){return async u=>{if(u instanceof Response){const f=u.headers.get(A);if(f!==null){k&&f.startsWith("/")?h(()=>{k(f,{replace:!0})}):window.location.href=f;return}u.customBody&&(u=await u.customBody())}if(p)throw u;return u}}};return o.keyFor=(...r)=>t+I(r),o.key=t,o}m.set=(e,t)=>{const o=v(),r=Date.now();let i=o.get(e);i?(i[0]=r,i[1]=t,i[2]="preload"):(o.set(e,i=[r,t,,C(r)]),i[3].count=0)};m.clear=()=>v().clear();function I(e){return JSON.stringify(e,(t,o)=>F(o)?Object.keys(o).sort().reduce((r,i)=>(r[i]=o[i],r),{}):o)}function F(e){let t;return e!=null&&typeof e=="object"&&(!(t=Object.getPrototypeOf(e))||t===Object.prototype)}function O(){return{id:"",gamemode:-1,maxPlayers:0,script:0}}function H(e){const t=O();return{id:e.resource_id!==void 0?e.resource_id:t.id,gamemode:e.resource_mode!==void 0?e.resource_mode:t.gamemode,maxPlayers:e.resource_max_player!==void 0?e.resource_max_player:t.maxPlayers,script:e.sandbox_script!==void 0?e.sandbox_script:t.script}}const R={0:"Original",2:"Team Deathmatch",5:"Bot Team Deathmatch",8:"Zombie Classic",9:"Zombie Mutant",14:"Zombie Hero",16:"Soccer",20:"Zombie Escape",22:"Gun Deathmatch",23:"Basic",24:"Bot Zombie",38:"Create",39:"Play",40:"All-Star",45:"Zombie Z",49:"Hide and Seek",52:"Zombie Shelter",53:"Scenario TX",54:"Zombie Evolution",[-1]:"!!!ERROR_FIXME!!!"};function S(){return{id:"",map:O(),parent:"",title:"",description:"",creatorName:"",categoryType:0,permissionType:0,tags:[],playCounts:0,likeCounts:0,bookmarkCounts:0,cubeCounts:0,cheeringKingName:"",savegroupId:"",imageId:"",groupId:"",noticeType:0,eventType:0}}Object.assign(S(),{id:"management"});const U="/studiobrowser/thumbnails/default.webp",$=m(async e=>e||U,"slot_thumbnail");function D(e,t){let o;t.imageId?o=e.vmg(t.imageId).href:t.map&&(o=`/studiobrowser/thumbnails/${t.map.gamemode}.webp`);let r="",i="",s="";const a=t.map;a&&(r=e.vxl(a.id).href,i=R[a.gamemode],s=new Date(Number.parseInt(a.id.substring(1,14))).toLocaleString());let w=new Date(Number.parseInt(t.id.substring(1,14))).toLocaleString();return{imageUrl:o,mapUrl:r,gamemodeName:i,createdDate:w,updatedDate:s}}function T(e){const t=S();return{id:e.id!==void 0?e.id:t.id,map:e.resource_id!==void 0?H(e):t.map,parent:e.parents_slot_id?T(e.parents_slot_id):t.parent,title:e.title!==void 0?e.title:t.title,description:e.description!==void 0?e.description:t.description,creatorName:e.creator_nickname!==void 0?e.creator_nickname:t.creatorName,categoryType:e.slot_category!==void 0?e.slot_category:t.categoryType,permissionType:e.permission!==void 0?e.permission:t.permissionType,tags:e.tags!==void 0?e.tags:t.tags,playCounts:e.play_count!==void 0?e.play_count:t.playCounts,likeCounts:e.like_count!==void 0?e.like_count:t.likeCounts,bookmarkCounts:e.bookmark_count!==void 0?e.bookmark_count:t.bookmarkCounts,cubeCounts:e.cube_count!==void 0?e.cube_count:t.cubeCounts,cheeringKingName:e.cheering_king!==void 0?e.cheering_king:t.cheeringKingName,savegroupId:e.savegroup_id!==void 0?e.savegroup_id:t.savegroupId,imageId:e.image_id!==void 0?e.image_id:t.imageId,groupId:e.group_id!==void 0?e.group_id:t.groupId,noticeType:e.notice_type!==void 0?e.notice_type:t.noticeType,eventType:e.is_event!==void 0?e.is_event:t.eventType}}const V=m(async(e,t)=>{let o={};try{const i=await e.api(`v5/slots/simple?ids=${t}`);Object.assign(o,i[0])}catch{}Object.assign(o,await e.api(`v6/slots/detail/${t}`));const r=T(o);return r._html=D(e,r),r},"slot_by_id"),X=m(async e=>{const t=await e.api("v6/slots/list/all");for(const o of Object.values(t))for(const r in o){const i=T(o[r]);i._html=D(e,i),o[r]=i}return t},"slot_list_all");export{U as S,V as a,X as f,$ as v};
